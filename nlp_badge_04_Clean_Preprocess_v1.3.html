<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-09-12">

<title>BADGE 2-4 Cleaning &amp; Preprocessing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="nlp_badge_04_Clean_Preprocess_v1.3_files/libs/clipboard/clipboard.min.js"></script>
<script src="nlp_badge_04_Clean_Preprocess_v1.3_files/libs/quarto-html/quarto.js"></script>
<script src="nlp_badge_04_Clean_Preprocess_v1.3_files/libs/quarto-html/popper.min.js"></script>
<script src="nlp_badge_04_Clean_Preprocess_v1.3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="nlp_badge_04_Clean_Preprocess_v1.3_files/libs/quarto-html/anchor.min.js"></script>
<link href="nlp_badge_04_Clean_Preprocess_v1.3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="nlp_badge_04_Clean_Preprocess_v1.3_files/libs/quarto-html/quarto-syntax-highlighting-3a01e2046221230fdceeea94b1ec5d67.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="nlp_badge_04_Clean_Preprocess_v1.3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="nlp_badge_04_Clean_Preprocess_v1.3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="nlp_badge_04_Clean_Preprocess_v1.3_files/libs/bootstrap/bootstrap-34745567add538a638dde46bc8a747e1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">BADGE 2-4 Cleaning &amp; Preprocessing</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 12, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="cleaning-and-preprocessing-text" class="level1">
<h1>Cleaning and Preprocessing Text</h1>
<section id="useful-libraries" class="level2">
<h2 class="anchored" data-anchor-id="useful-libraries">Useful Libraries</h2>
<p>There are many <strong>packages/libraries</strong> for cleaning text and we will show some different options. We encourage you to read up on these packages and become familiar with their commands.</p>
<p>First lets load some libraries we will need. Remember that if a library is not already installed in your system, you’ll have to use <code>install.packages("libraryname")</code> before <code>library(libraryname)</code>.</p>
<p>Noteable system already will come pre-loaded with most of the libraries we need, but when you work on your own projects later, you will need to keep in what already installed, and what you need to install.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first some imports:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(readr)){</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"readr"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(dplyr)){</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(tidytext)){</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"tidytext"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(stringr)){</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"stringr"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="finding-and-replacing-numbers" class="level2">
<h2 class="anchored" data-anchor-id="finding-and-replacing-numbers">Finding and replacing numbers</h2>
<p>In this first example we are going to use a regular expression with the <code>gsub</code> command to find and replace numbers to a standardised term ‘DIGIT’</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#String with numbers</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>my_digits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"13 September: My number is 07234 and I live at 8 fleet street. I have lived there since 2021"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_digits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "13 September: My number is 07234 and I live at 8 fleet street. I have lived there since 2021"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The regular expression in gsub finds numbers at the start followed by a single space OR any numbers preceded and followed by a single space</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>my_digits <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'^</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">s|</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">s'</span>, <span class="st">' DIGIT '</span>, my_digits) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_digits) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] " DIGIT September: My number is DIGIT and I live at DIGIT fleet street. I have lived there since 2021"</code></pre>
</div>
</div>
<p>Why did it not match the year at the end?</p>
</section>
<section id="activity-make-the-regular-expression-more-universal" class="level2">
<h2 class="anchored" data-anchor-id="activity-make-the-regular-expression-more-universal">Activity: Make the regular expression more universal</h2>
<p>What is special about the number that did not get ‘captured’ by that regex? Thinking about the regular expressions you learned in Week 1 can you fix this?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>your_regex <span class="ot">&lt;-</span> <span class="st">'^</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">s|</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">s|</span><span class="sc">\\</span><span class="st">d+$'</span> <span class="co"># adjust this regex!</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>my_digits <span class="ot">&lt;-</span> <span class="fu">gsub</span>(your_regex, <span class="st">' DIGIT '</span>, my_digits) <span class="co">#</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_digits) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] " DIGIT September: My number is DIGIT and I live at DIGIT fleet street. I have lived there since  DIGIT "</code></pre>
</div>
</div>
<p><a href="./hints/hint_4_1.Rmd">Answer:</a></p>
<p><strong>Normalising Special Characters and Abbreviations</strong></p>
<p>First, we will use a regular expression to find URLs and replace with the term ‘WEBSITE’.</p>
<p>Second, we will look for different abbreviations of USA and normalise these to one abbreviation type.</p>
<p>What does regex <code>\S+</code> do?</p>
<blockquote class="blockquote">
<p>From testing on the <a href="https://regex101.com/r/1DtLCt/1">regrex101 website</a>. It matches any non-whitespace character (equivalent to <code>[^\r\n\t\f\v ]</code>).</p>
</blockquote>
<p><a href="./hints/hint_4_2.Rmd">HINT</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#URL Detection</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"My website is at http://www.ed.ac.uk"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "My website is at http://www.ed.ac.uk"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this regex removes the URL and replaces with WEBSITE</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'http</span><span class="sc">\\</span><span class="st">S+</span><span class="sc">\\</span><span class="st">s*'</span>, <span class="st">'WEBSITE'</span>, my_url)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_url)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "My website is at WEBSITE"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ABBREVIATIONS</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>my_abbrev <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"I used to live in U.S.A. but I no longer live in the US I live in Scotland"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_abbrev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "I used to live in U.S.A. but I no longer live in the US I live in Scotland"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># looks for abbreviation of USA (U.S.A, US, U.S.) and replaces these with USA.</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>my_abbrev1 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'(U</span><span class="sc">\\</span><span class="st">.S</span><span class="sc">\\</span><span class="st">.|USA|US|U</span><span class="sc">\\</span><span class="st">.S</span><span class="sc">\\</span><span class="st">.A</span><span class="sc">\\</span><span class="st">.)'</span>,<span class="st">"USA"</span>, my_abbrev)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_abbrev1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "I used to live in USA but I no longer live in the USA I live in Scotland"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># trying  different way</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>my_abbrev2 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'(U</span><span class="sc">\\</span><span class="st">.*S</span><span class="sc">\\</span><span class="st">.*|U</span><span class="sc">\\</span><span class="st">.*S</span><span class="sc">\\</span><span class="st">.*A</span><span class="sc">\\</span><span class="st">.*)'</span>,<span class="st">"USA"</span>, my_abbrev)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_abbrev2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "I used to live in USA but I no longer live in the USA I live in Scotland"</code></pre>
</div>
</div>
</section>
<section id="punctuation" class="level2">
<h2 class="anchored" data-anchor-id="punctuation">Punctuation</h2>
<p>How you remove punctuation is important as you may need it for further downstream analysis for example if you want to tokenise the document into sentences so <code>.?!</code> will be important, and maybe should not be simply removed…</p>
<p>Note: there exist some ‘character classes’ which have a special notation in R regex. If you want to use a space, you’d use <code>\s</code>, digit is <code>\d</code> but there are some more complex ones like <code>[[:punct:]]</code> for punctuation, or <code>[[upper]]</code> for upper-case characters. Regex truly is a huge and fascinating topic.</p>
<p>Have a look at the examples below - what do they do?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>my_sentences<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Hello, how are you today? I'm looking forward to fun with NLP. Are you?"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_sentences)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello, how are you today? I'm looking forward to fun with NLP. Are you?"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove some specific characters</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>my_sentences0<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">'[?!</span><span class="sc">\\</span><span class="st">.]+'</span>,<span class="st">''</span>,my_sentences)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_sentences0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello, how are you today I'm looking forward to fun with NLP Are you"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all known punctuation</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>my_sentences1<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">'[[:punct:]]'</span>,<span class="st">''</span>,my_sentences)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_sentences1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello how are you today Im looking forward to fun with NLP Are you"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ooops: do you see something funny happening here? Hint: look around "I'm"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Oh no! we lost all punctuation! Which means we actually lost a lot of information. Plus we also removed the <code>'</code></p>
<p>When building regex, there is often a temptation to be too specific and too smart. See below as a cautionary tale.</p>
<p>e.g.&nbsp;But what if you wanted to retain some very specific punctuation, let’s say all <code>'</code> ?</p>
<p>(Kind note: We’re just showing this to you, so you can see how incredibly tricky regex can get. If you’re not up for tricky stuff just now, scroll down to the part saying “Ok. Breathe in - breathe out.”, and maybe return here one day!)</p>
</section>
<section id="advanced-regex-lookups-expect-things-beforeafter-but-do-not-include-them-in-the-match" class="level2">
<h2 class="anchored" data-anchor-id="advanced-regex-lookups-expect-things-beforeafter-but-do-not-include-them-in-the-match">(advanced regex): Lookups (expect things before/after, but do not include them in the match)</h2>
<p>this bit is so tricky you need to enable more complex regex features with <code>perl=TRUE</code>. It uses <code>lookup</code> syntax where <code>?</code> means lookup, <code>!</code> means NOT and <code>&lt;</code> means before. See below:</p>
<ul>
<li><code>(?=SOMETHING)</code> - followed by SOMETHING</li>
<li><code>(?!SOMETHING)</code> - NOT followed by SOMETHING</li>
<li><code>(?&lt;=SOMETHING)</code> - proceeded by SOMETHING</li>
<li><code>(?&lt;!SOMETHING)</code> - NOT proceeded by SOMETHING</li>
</ul>
<p>Have a look at this code and what it does:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>snacks <span class="ot">&lt;-</span> (<span class="st">"pineapple apple applepie sweetwater water watermelon "</span>) </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>snacks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "pineapple apple applepie sweetwater water watermelon "</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>snacks<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">'apple(?=pie)'</span>,<span class="st">'11111'</span>,snacks, <span class="at">perl=</span><span class="cn">TRUE</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>snacks  <span class="co"># replace apple only when followed by pie (leave other apples alone)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "pineapple apple 11111pie sweetwater water watermelon "</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>snacks<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">'water(?!</span><span class="sc">\\</span><span class="st">s)'</span>,<span class="st">'22222'</span>,snacks, <span class="at">perl=</span><span class="cn">TRUE</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>snacks <span class="co"># replace water NOT followed by space </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "pineapple apple 11111pie sweetwater water 22222melon "</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>snacks<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">'(?&lt;=pine)apple'</span>,<span class="st">'33333'</span>,snacks, <span class="at">perl=</span><span class="cn">TRUE</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>snacks <span class="co"># replace apple proceeded by pine </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "pine33333 apple 11111pie sweetwater water 22222melon "</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>snacks<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">'(?&lt;!sweet)water'</span>,<span class="st">'44444'</span>,snacks, <span class="at">perl=</span><span class="cn">TRUE</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>snacks <span class="co"># replace water NOT proceeded by sweet </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "pine33333 apple 11111pie sweetwater 44444 22222melon "</code></pre>
</div>
</div>
<p>Back to our example:</p>
<p>We could say any punctuation not proceeded by ’ (i.e.&nbsp;all punctuation, apart of an actual ’).</p>
<p>For an extra curve-ball: - if you surround regex with ” you do not need to escape ’ - <code>"I'm hungry"</code> - if you surround regex with ’ you do not need to escape ” - <code>'that is "nice"'</code> - but if you want to use the same bracket in regex, which you used to surround regex… you need to escape it <code>'I\'m hungry'</code> or <code>"that is \"nice\""</code></p>
<p>This is important because we want to say “each punctuation not proceeded by”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>my_sentences3<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">"(?!')[[:punct:]]"</span>,<span class="st">''</span>,my_sentences, <span class="at">perl=</span><span class="cn">TRUE</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>my_sentences3 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello how are you today I'm looking forward to fun with NLP Are you"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>my_sentences3<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">'(?!</span><span class="sc">\'</span><span class="st">)[[:punct:]]'</span>,<span class="st">''</span>,my_sentences, <span class="at">perl=</span><span class="cn">TRUE</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>my_sentences3 <span class="co"># another curve ball</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello how are you today I'm looking forward to fun with NLP Are you"</code></pre>
</div>
</div>
<p>What happened above? Try to get it, maybe change it a bit. But also, this level of complexity is a bit beyond the scope of this badge.</p>
<blockquote class="blockquote">
<p>I don’t quite understand the lookahead above… I would expect the “(?!’)” to mean “not followed by ‘“, but here the”’” in “I’m” is followed by an “m”, so I would expect it to be removed?</p>
</blockquote>
<p><strong>OK. Breathe in - breathe out. Is there a simpler way to not lose punctuation.</strong></p>
<p>Let’s take a step back and ask ourselves what we want to do. For example:</p>
<p>I want to be able to separate sentences, but not lose the exact place where they finished! Let’s solve it by adding a new special symbol <code>[EOS]</code> (literally “open bracket, then three letters E, O and S, then close bracket”). But it is often agreed to mean <code>End Of Sentence</code>. This way we unify the <code>!?.</code> into a new symbol (that we sort of invented), the <code>[EOS]</code>.</p>
<p>This way you could: count sentences. Split whole string into individual sentences. And much more, but without having to always refer to all the ways in which sentence can end (i.e.&nbsp;<code>?</code> <code>!</code> and <code>.</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let's use this regex meaning: all !?. followed by a space, or end of string. </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and replace them with [EOS]</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>my_sentences3 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'[!?</span><span class="sc">\\</span><span class="st">.](</span><span class="sc">\\</span><span class="st">s+)|[!?</span><span class="sc">\\</span><span class="st">.]$'</span>, <span class="st">'[EOS]'</span>, my_sentences, <span class="at">perl =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_sentences3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello, how are you today[EOS]I'm looking forward to fun with NLP[EOS]Are you[EOS]"</code></pre>
</div>
</div>
<p>Consider the last example do you see any challenges with this matching strategy and think of ways to overcome this?</p>
</section>
<section id="activity-contractions-youd-love-to-come-back-to-the-or-you-would-love-to-come-back-to-the" class="level2">
<h2 class="anchored" data-anchor-id="activity-contractions-youd-love-to-come-back-to-the-or-you-would-love-to-come-back-to-the">ACTIVITY: Contractions: “You’d love to come back to the <code>'</code>?” or “You would love to come back to the <code>'</code> ?”</h2>
<p>Can you come up with a regular expression for finding contractions in these strings and making the same words be similar? (<code>we're</code> into <code>we are</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"I won't be at class tonight as I can't find my car keys. Please don't forget to tell the teacher I'm sorry, I don't want her to think I've forgotten about it. You'll remember to tell her, won't you? I'll see you tommorrow."</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># try to write a bunch of lines of code with replacements which will 'lengthen' all short forms like "don't" into "do not". </span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Do it as a series of steps, each improving the main sentence:</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'we</span><span class="sc">\'</span><span class="st">re'</span>, <span class="st">'we are'</span>, my_string)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'something'</span>, <span class="st">'something_else'</span>, my_string)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'something22'</span>, <span class="st">'something_else2'</span>, my_string)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ... more code here</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"won't"</span>, <span class="st">"will not"</span>, my_string) </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"can't"</span>, <span class="st">"cannot"</span>, my_string) </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"don't"</span>, <span class="st">"do not"</span>, my_string) </span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"I'm"</span>, <span class="st">"I am"</span>, my_string) </span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"'ve"</span>, <span class="st">" have"</span>, my_string) </span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"I'll"</span>, <span class="st">"I will"</span>, my_string) </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"You'll"</span>, <span class="st">"You will"</span>, my_string) </span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_string)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "I will not be at class tonight as I cannot find my car keys. Please do not forget to tell the teacher I am sorry, I do not want her to think I have forgotten about it. You will remember to tell her, will not you? I will see you tommorrow."</code></pre>
</div>
</div>
<p><a href="./hints/hint_4_3.Rmd">HINTS</a></p>
</section>
<section id="activity-remove-accidental-extra-spaces" class="level2">
<h2 class="anchored" data-anchor-id="activity-remove-accidental-extra-spaces">ACTIVITY: Remove accidental extra spaces:</h2>
<p>In the following string can you remove the extra white space?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>cont_string <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">" I won't be at class tonight as I cant find my car keys.  Please don' t forget to    take tell  the teacher I'm sorry, I do not want her to think I forgot. I'll see you tommorrow .    "</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># your code below</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'something'</span>, <span class="st">'something_else'</span>, cont_string)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ... more code here, it could also be a chain.</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># remove simple spaces first, then trickier ones!</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># replace all places with 2 or more spaces with a single space</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'</span><span class="sc">\\</span><span class="st">s{2,}'</span>, <span class="st">' '</span>, my_string)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># remove space at the beginning and end</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'^</span><span class="sc">\\</span><span class="st">s+|</span><span class="sc">\\</span><span class="st">s+$'</span>, <span class="st">''</span>, my_string)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="co"># remove space after apostrophe</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'</span><span class="sc">\\</span><span class="st">s*</span><span class="sc">\'\\</span><span class="st">s*'</span>, <span class="st">'</span><span class="sc">\'</span><span class="st">'</span>, my_string)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co"># remove space before full stop</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>my_string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'</span><span class="sc">\\</span><span class="st">s+</span><span class="sc">\\</span><span class="st">.'</span>, <span class="st">'</span><span class="sc">\\</span><span class="st">.'</span>, my_string)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_string)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "I won't be at class tonight as I cant find my car keys. Please don't forget to take tell the teacher I'm sorry, I do not want her to think I forgot. I'll see you tommorrow."</code></pre>
</div>
</div>
<p><a href="./hints/hint_4_4.Rmd">HINTS</a></p>
<p>There is the package <code>cleantext</code> which can help with these things more automatically</p>
<blockquote class="blockquote">
<p>the <a href="https://github.com/laresbernardo/lares"><code>lares</code></a> package looks interesting?</p>
</blockquote>
</section>
<section id="tokenisation" class="level2">
<h2 class="anchored" data-anchor-id="tokenisation">Tokenisation</h2>
<p>Tokenisation, this is splitting a string into separate meaningful components. This is usually words but could be sentences, sub words or phrases.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>token_string <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"We Love NLP! Isn't it great? I think so."</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(token_string)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "We Love NLP! Isn't it great? I think so."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#splitting on string between spaces</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>new_token_string <span class="ot">&lt;-</span> <span class="fu">str_split</span>(token_string,<span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>) </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(new_token_string)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "We"     "Love"   "NLP!"   "Isn't"  "it"     "great?" "I"      "think" 
[9] "so."   </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Not sure why you’d bother with the tidyverse when there’s a base R version?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">strsplit</span>(token_string, <span class="st">'</span><span class="sc">\\</span><span class="st">s+'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "We"     "Love"   "NLP!"   "Isn't"  "it"     "great?" "I"      "think" 
[9] "so."   </code></pre>
</div>
</div>
<p>Note: Here our words are ‘polluted’ by punctuation, like “great?”. You already know how to remove punctuation using regex, and also there are several R packages that undertake text based tokenisation for you.</p>
<p>We are going to use features from <code>tidyverse</code> and <code>tidytext</code> but there are many others out there (such as the <code>tm</code> package)</p>
<p>First we will load the libraries needed. (remember <code>install.packages("libraryname")</code> if these are not already installed</p>
<p>Note <code>tidytext</code> expects data to be in a tibble format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(tidytext)){</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"tidytext"</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(tibble)){</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"tibble"</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(dplyr)){</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggplot2)){</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This converts the data to a tibble format and separates each row of the dataframe word by word (remember tibbles from week 1)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>my_text <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Oh! what a lovely day it is, for today we are having fun with NLP. We will learn about cleaning our text"</span>, </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"My cat is tired today. She is sleeping on her mat in the sun.  She will wake when she is hungry."</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We first put our text into the tibble dataframe. It will have two columns:</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 'line' with numbers from 1 to 2  (since string above has two rows)</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 'text' which will hold two lines from the collection above.</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># these texts are not yet divided into sentences (the first has two sentences and the second 3 sentences.)</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>my_text_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">line=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">text=</span>my_text) </span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co"># my_text_df &lt;- tibble(line=1:length(my_text), text=my_text)  # this would be a more universal version</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co">#show our tibble dataframe</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>my_text_df </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
   line text                                                                    
  &lt;int&gt; &lt;chr&gt;                                                                   
1     1 Oh! what a lovely day it is, for today we are having fun with NLP. We w…
2     2 My cat is tired today. She is sleeping on her mat in the sun.  She will…</code></pre>
</div>
</div>
<p>We can now convert our text into our desired tokenised form.</p>
<p>We are going to start by tokenising our text into words using the <code>unnest_tokens</code> function. Use <code>help(unnest_tokens)</code> to see options for this function.</p>
<p><strong>a note about a %&gt;% PIPE</strong></p>
<p>If you’ve never see <code>%&gt;%</code> syntax, it is called <code>PIPE</code> (like in plumbing) and is a part of possibly most powerful and popular R library called <code>tidyverse</code>. Pipe means: take the data on the left, and ‘pipe them/feed them’ into the code on the right. The code on the right is usually a function, in which case the ‘piped’ data is fed into the <code>first argument</code> of that function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nchar</span>(<span class="st">"banana"</span>) <span class="co"># nchar function takes one argument: the string of which it will return a "number of characters" (length)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># but with pipe, we do not give an argument to nchar() but instead we pipe/feed collection of 3 words into it,</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and pipe will 'feed' each item in the collection into nchar() as its fitst argument, one after another</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"banana"</span>,<span class="st">"kiwi"</span>,<span class="st">"pear"</span>)  <span class="sc">%&gt;%</span> <span class="fu">nchar</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6 4 4</code></pre>
</div>
</div>
<p>OK, back to the tokens:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The unnest_tokens function is given three arguments:</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - the 'piped' elements of my_text_df</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - 'word' which tells it to name the resulting column 'word'</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - name of the column in the tibble which should be used (in our example, we called that column 'text') </span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># by default, the tokenisation is by words, but you can change that with the 'token' argument</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>my_text_df <span class="sc">%&gt;%</span> <span class="fu">unnest_tokens</span>(word,text) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 43 × 2
    line word  
   &lt;int&gt; &lt;chr&gt; 
 1     1 oh    
 2     1 what  
 3     1 a     
 4     1 lovely
 5     1 day   
 6     1 it    
 7     1 is    
 8     1 for   
 9     1 today 
10     1 we    
# ℹ 33 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># but why bother with the pipe?</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unnest_tokens</span>(my_text_df, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>              <span class="co"># output column name</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>              word, </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>              <span class="co"># input column name</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>              text,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>              <span class="co"># what to tokenise by (default `word`)</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">token =</span> <span class="st">"words"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 43 × 2
    line word  
   &lt;int&gt; &lt;chr&gt; 
 1     1 oh    
 2     1 what  
 3     1 a     
 4     1 lovely
 5     1 day   
 6     1 it    
 7     1 is    
 8     1 for   
 9     1 today 
10     1 we    
# ℹ 33 more rows</code></pre>
</div>
</div>
<p>It is possible to lowercase text and strip punctuation whilst unnesting the tokens. Punctuation is removed by default, where unnest_tokens assumes you said <code>strip_punct = TRUE</code> if you said nothing to the contrary (because it is so common). But if you actually want to keep punctuation, you need to request it specifically with <code>strip_punct = FALSE</code>.</p>
<p>By default <code>unnest_tokens</code> converts text to lowercase you can turn this off by <code>to_lower=FALSE</code> as an argument. This can be useful at this stage as you try to understand the data. And losing sizes of letters might hide some meanings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unnest_tokens</span>(my_text_df, word, text, <span class="at">to_lower =</span> <span class="cn">FALSE</span>, <span class="at">strip_punct =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 43 × 2
    line word  
   &lt;int&gt; &lt;chr&gt; 
 1     1 Oh    
 2     1 what  
 3     1 a     
 4     1 lovely
 5     1 day   
 6     1 it    
 7     1 is    
 8     1 for   
 9     1 today 
10     1 we    
# ℹ 33 more rows</code></pre>
</div>
</div>
</section>
<section id="n-grams-more-than-one-word" class="level2">
<h2 class="anchored" data-anchor-id="n-grams-more-than-one-word">N-grams: more than one word</h2>
<p>In the example we tokenise by two word phrases and then by sentences.</p>
<p>Remember multiple words phrases are also called n-grams, where <code>n</code> represents the number of words 2-gram are called bigrams.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#tokenise by bigrams</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>my_text_df <span class="sc">%&gt;%</span> <span class="fu">unnest_tokens</span>(ngram, text, <span class="at">token=</span><span class="st">"ngrams"</span>, <span class="at">n=</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 41 × 2
    line ngram     
   &lt;int&gt; &lt;chr&gt;     
 1     1 oh what   
 2     1 what a    
 3     1 a lovely  
 4     1 lovely day
 5     1 day it    
 6     1 it is     
 7     1 is for    
 8     1 for today 
 9     1 today we  
10     1 we are    
# ℹ 31 more rows</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>this overlapping output is a bit similar to what convolution filters do in convolution neutral networks</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#In this example we tokenise by sentences</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>my_text_df <span class="sc">%&gt;%</span> <span class="fu">unnest_tokens</span>(sentence, text, <span class="at">token=</span><span class="st">"sentences"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
   line sentence                                                      
  &lt;int&gt; &lt;chr&gt;                                                         
1     1 oh!                                                           
2     1 what a lovely day it is, for today we are having fun with nlp.
3     1 we will learn about cleaning our text                         
4     2 my cat is tired today.                                        
5     2 she is sleeping on her mat in the sun.                        
6     2 she will wake when she is hungry.                             </code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># notice that the result below probably shows you two grey rectangles: previews of the results of your pipes.</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This is equivalent of you printing two lines of text, but this data is better formatted</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can use regular expressions to tokenise in different ways. For example if each document had a chapter header.</p>
<p>Below we tokenise by CHAPTER markers in the text. We create some text with chapter markers (CHAPTER) and turn into a tibble data frame below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>my_text2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CHAPTER 1 Oh what a lovely day it is, for today we are having fun with NLP. CHAPTER 2 We will learn about cleaning our text"</span>, <span class="st">"CHAPTER 3 My cat is tired today. She is sleeping on her mat in the sun.  CHAPTER 4 She will wake when she is hungry."</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co">#turn data into a tibble</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>my_text_df2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">line=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">text=</span>my_text2)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we tokenize based on the CHAPTER separator</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>my_text_df2 <span class="sc">%&gt;%</span> <span class="fu">unnest_tokens</span>(chapter, text, <span class="at">token=</span><span class="st">"regex"</span>, <span class="at">pattern =</span> <span class="st">"CHAPTER</span><span class="sc">\\</span><span class="st">s+</span><span class="sc">\\</span><span class="st">d+"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
   line chapter                                                              
  &lt;int&gt; &lt;chr&gt;                                                                
1     1 " oh what a lovely day it is, for today we are having fun with nlp. "
2     1 " we will learn about cleaning our text"                             
3     2 " my cat is tired today. she is sleeping on her mat in the sun.  "   
4     2 " she will wake when she is hungry."                                 </code></pre>
</div>
</div>
<p>(hey! do you remember our <code>[EOS]</code> token from before? Do you see where this is going?)</p>
</section>
<section id="activity-load-a-text-file-and-clean-up-the-data" class="level2">
<h2 class="anchored" data-anchor-id="activity-load-a-text-file-and-clean-up-the-data">ACTIVITY: Load a text file and clean up the data</h2>
<p>Read in the random text file (<code>random.txt</code>), and tokenise it into sentences making it into lowercase and removing the punctuation.</p>
<p>Reading in this kind of text file is different to what you have seen before. The starting code below includes some code to show you how to do this using the <code>readline</code> function and <code>paste</code> (from week 1).</p>
<p>If you want to try find more details about those, try <em>help(readlines)</em> to see if you can work out how to bring the data in. Don’t forget to turn it into a tibble to use unnest_tokens.</p>
<p>The first part is given to you: read the file and turn it into a tibble:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the file</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">"./data/random.txt"</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>text_content <span class="ot">&lt;-</span> <span class="fu">readLines</span>(file_path) <span class="co"># Read lines from the file</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>single_string <span class="ot">&lt;-</span> <span class="fu">paste</span>(text_content, <span class="at">collapse =</span> <span class="st">" "</span>) <span class="co"># Collapse the lines into a single string</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>text_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">text =</span> single_string, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># First create a dataframe with one column named "text"</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>text_tb <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">list</span>(<span class="at">text =</span> single_string)) <span class="co"># then tibble it. Notice it can be a two step process.</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(text_tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  text                                                                          
  &lt;chr&gt;                                                                         
1 In the heart of a bustling city, a quaint little café nestled between towerin…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>text_tb <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(text_df) <span class="co"># then tibble it. Notice it can be a two step process.</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(text_tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  text                                                                          
  &lt;chr&gt;                                                                         
1 In the heart of a bustling city, a quaint little café nestled between towerin…</code></pre>
</div>
</div>
<p>At this point is it still a very long string with all the punctuation and letter sizes. Not your turn:</p>
<p>Use the <code>%&gt;%</code> pipe and <code>unnest_tokens</code> to split this tibble into cleaned up sentences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#unnest the tokens to sentences, strip punctuation and lower case, like:</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># text_tb %&gt;%  something???</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># nb unnest_tokens can take data.frames and tibbles:</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># it outputs in the same format as input</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="fu">unnest_tokens</span>(text_df, sentences, text, <span class="at">token =</span> <span class="st">"sentences"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                                                                                                                  sentences
1                                                   in the heart of a bustling city, a quaint little café nestled between towering skyscrapers offered a cozy retreat from the urban chaos.
2                                                   the aroma of freshly brewed coffee wafted through the air, mingling with the sweet scent of pastries that lined the glass display case.
3                                                                              locals gathered at small wooden tables, engaged in lively conversations or quietly engrossed in their books.
4                                                                        outside, the world rushed by, but inside, time seemed to slow down, allowing moments of connection and reflection.
5 as the sun dipped below the horizon, casting a warm golden glow, the café transformed into a haven of warmth and comfort, inviting all who entered to savor the simple pleasures of life.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unnest_tokens</span>(text_tb, sentences, text, <span class="at">token =</span> <span class="st">"sentences"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
  sentences                                                                     
  &lt;chr&gt;                                                                         
1 in the heart of a bustling city, a quaint little café nestled between towerin…
2 the aroma of freshly brewed coffee wafted through the air, mingling with the …
3 locals gathered at small wooden tables, engaged in lively conversations or qu…
4 outside, the world rushed by, but inside, time seemed to slow down, allowing …
5 as the sun dipped below the horizon, casting a warm golden glow, the café tra…</code></pre>
</div>
</div>
<p><a href="./hints/hint_4_5.Rmd">if you are struggling after a few minutes, have a look here</a></p>
</section>
</section>
<section id="reflection" class="level1">
<h1>Reflection:</h1>
<p>Now is a good moment to write down your self reflection: think of 3 STARS (things that you learned in this badge), and 1 WISH: a thing you wish you understood better. You might also thing of what would you do to fulfill your wish. Write them down.</p>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion:</h1>
<p>Now you know much more about cleaning up and preparing your datasets, in preparation for looking for some insights in your data!</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>